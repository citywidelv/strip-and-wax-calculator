<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Wide Strip & Wax Floor Pricing Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border: 1px solid #e9ecef;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .input-group small {
            display: block;
            margin-top: 5px;
            font-size: 12px;
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }
        
        .results-section {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            padding: 30px;
            margin-top: 20px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }
        
        .result-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .result-card .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #3498db;
        }
        
        .production-rates {
            grid-column: 1 / -1;
            margin-top: 30px;
        }
        
        .rates-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .rates-table th {
            background: #2c3e50;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .rates-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .rates-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .rates-table tr:hover {
            background: #e3f2fd;
        }
        
        .breakdown-section {
            grid-column: 1 / -1;
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-top: 20px;
            border: 1px solid #dee2e6;
        }
        
        .material-calc {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .material-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #28a745;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Strip & Wax Floor Pricing Calculator</h1>
            <p>Professional Time & Material Calculations Based on Industry Standards</p>
        </div>
        
        <div class="main-content">
            <!-- Project Details Section -->
            <div class="section">
                <h2>Project Details</h2>
                <div class="input-group">
                    <label for="squareFootage">Total Square Footage</label>
                    <input type="number" id="squareFootage" placeholder="Enter square footage" value="5000">
                </div>
                
                <div class="input-group">
                    <label for="floorType">Floor Type</label>
                    <select id="floorType">
                        <option value="vct">VCT Tile (Standard)</option>
                        <option value="linoleum">Linoleum</option>
                        <option value="luxury_vinyl">Luxury Vinyl Tile (LVT)</option>
                        <option value="composition">Composition Tile</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="condition">Current Floor Condition</label>
                    <select id="condition">
                        <option value="good">Good - Recent maintenance</option>
                        <option value="fair">Fair - Normal wear</option>
                        <option value="poor">Poor - Heavy buildup</option>
                        <option value="very_poor">Very Poor - Multiple layers</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="density">Furniture Density & Moving</label>
                    <select id="density">
                        <option value="none">No Furniture - Open areas</option>
                        <option value="minimal">Minimal - Light furniture, easy to move</option>
                        <option value="light">Light - Some desks/chairs to move</option>
                        <option value="medium">Medium - Moderate furniture density</option>
                        <option value="heavy">Heavy - Dense furniture, complex moving</option>
                        <option value="very_heavy">Very Heavy - Extensive furniture/equipment</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="coats">Number of Finish Coats</label>
                    <select id="coats">
                        <option value="3">3 Coats (Standard)</option>
                        <option value="4">4 Coats (Recommended)</option>
                        <option value="5">5 Coats (High Traffic)</option>
                    </select>
                </div>
            </div>
            
            <!-- Vendor Labor & Equipment Section -->
            <div class="section">
                <h2>Vendor Labor & Equipment</h2>
                <div class="input-group">
                    <label for="rawLaborRate">Raw Floor Care Labor Rate ($/hour)</label>
                    <input type="number" id="rawLaborRate" step="0.50" value="16.00" onchange="updateVendorRate()">
                    <small style="color: #666;">Floor care workers typically earn $2-3 more than janitorial</small>
                </div>
                
                <div class="input-group">
                    <label for="loadFactor">Vendor Load Factor</label>
                    <input type="number" id="loadFactor" step="0.05" value="1.50" onchange="updateVendorRate()">
                    <small style="color: #666;">Covers FICA, FUTA, Workers Comp, GL, overhead & vendor profit</small>
                </div>
                
                <div class="input-group">
                    <label for="vendorLoadedRate">Vendor Loaded Rate ($/hour)</label>
                    <input type="number" id="vendorLoadedRate" step="0.50" value="24.00" readonly style="background-color: #f8f9fa;">
                    <small style="color: #666;">Auto-calculated: $16.00 × 1.50 = $24.00</small>
                </div>
                
                <div class="input-group">
                    <label for="stripperCasePrice">SC Johnson Stripper Price ($/case)</label>
                    <input type="number" id="stripperCasePrice" step="1.00" value="90.00">
                    <small style="color: #666;">2-gallon concentrate case, makes up to 50 gallons diluted</small>
                </div>
                
                <div class="input-group">
                    <label for="finishCasePrice">SC Johnson Finish Price ($/case)</label>
                    <input type="number" id="finishCasePrice" step="1.00" value="140.00">
                    <small style="color: #666;">5-gallon case, ready-to-use finish</small>
                </div>
                
                <div class="input-group">
                    <label for="crewSize">Crew Size</label>
                    <select id="crewSize">
                        <option value="1">1 Person</option>
                        <option value="2">2 People (Recommended)</option>
                        <option value="3">3 People (Large Areas)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="equipmentRate">Equipment Rate ($/hour)</label>
                    <input type="number" id="equipmentRate" step="0.50" value="8.00">
                    <small style="color: #666;">Covers transport, setup, depreciation & maintenance</small>
                </div>
                
                <div class="input-group">
                    <label for="cwMargin">City Wide Margin (%)</label>
                    <input type="number" id="cwMargin" step="1" value="35" min="0" max="50">
                    <small style="color: #666;">Applied to both labor and materials (divide cost by 0.65)</small>
                </div>
                
                <div class="input-group">
                    <label for="timeOfService">Time of Service</label>
                    <select id="timeOfService">
                        <option value="normal">Normal Hours</option>
                        <option value="overtime">After Hours (+25%)</option>
                        <option value="weekend">Weekend (+35%)</option>
                    </select>
                </div>
                
                <button class="btn" onclick="calculatePricing()">Calculate Strip & Wax Pricing</button>
            </div>
        </div>
        
        <!-- Results Section -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <h2>Pricing Results</h2>
            <div class="results-grid">
                <div class="result-card">
                    <h3>Total Labor Hours</h3>
                    <div class="value" id="totalHours">0</div>
                </div>
                <div class="result-card">
                    <h3>Vendor Labor Cost</h3>
                    <div class="value" id="vendorLaborCost">$0</div>
                </div>
                <div class="result-card">
                    <h3>Equipment Cost</h3>
                    <div class="value" id="equipmentCost">$0</div>
                </div>
                <div class="result-card">
                    <h3>Material Cost (w/ Margin)</h3>
                    <div class="value" id="materialCost">$0</div>
                </div>
                <div class="result-card">
                    <h3>Total Cost to CW</h3>
                    <div class="value" id="totalCost">$0</div>
                </div>
                <div class="result-card">
                    <h3>Price Per Sq Ft</h3>
                    <div class="value" id="pricePerSqFt">$0.00</div>
                </div>
                <div class="result-card">
                    <h3>Final Client Price</h3>
                    <div class="value" id="bidPrice">$0</div>
                </div>
                <div class="result-card">
                    <h3>CW Gross Profit</h3>
                    <div class="value" id="cwProfit">$0</div>
                </div>
            </div>
        </div>
        
        <!-- Production Rates Reference -->
        <div class="production-rates">
            <h2>Industry Production Rates Reference</h2>
            <table class="rates-table">
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Production Rate</th>
                        <th>Equipment</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Strip Floor - Good Condition</td>
                        <td>1,200 sq ft/day (2 people)</td>
                        <td>175rpm 20" Floor Machine + Wet Vacuum</td>
                        <td>~150 sq ft/hr per person - ISSA realistic</td>
                    </tr>
                    <tr>
                        <td>Strip Floor - Poor Condition</td>
                        <td>800 sq ft/day (2 people)</td>
                        <td>175rpm 20" Floor Machine + Wet Vacuum</td>
                        <td>Multiple layers, heavy buildup</td>
                    </tr>
                    <tr>
                        <td>Apply Finish - 3 Coats</td>
                        <td>2,400 sq ft/day (2 people)</td>
                        <td>18" Microfiber Mop & Bucket</td>
                        <td>Includes drying time between coats</td>
                    </tr>
                    <tr>
                        <td>Apply Finish - 4+ Coats</td>
                        <td>2,000 sq ft/day (2 people)</td>
                        <td>18" Microfiber Mop & Bucket</td>
                        <td>High-traffic areas, more coats</td>
                    </tr>
                    <tr>
                        <td>Prep Work (Sweep/Tack)</td>
                        <td>4,000 sq ft/day (1 person)</td>
                        <td>48" Push Broom + Tack Cloth</td>
                        <td>Between strip and finish phases</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Detailed Breakdown -->
        <div class="breakdown-section" id="breakdownSection" style="display: none;">
            <h2>Detailed Cost Breakdown</h2>
            <div id="detailedBreakdown"></div>
            
            <h3 style="margin-top: 25px; color: #2c3e50;">Material Calculator</h3>
            <div class="material-calc" id="materialCalc"></div>
        </div>
    </div>

    <script>
        // Production rates based on ISSA standards and realistic industry data
        const productionRates = {
            strip: {
                good: 1200,
                fair: 1000,
                poor: 800,
                very_poor: 600
            },
            finish: {
                3: 2400,
                4: 2000,
                5: 1600
            },
            prep: 4000
        };
        
        // Material coverage rates - SC Johnson specific
        const materialCoverage = {
            stripper: 600,
            sealer: 3000,
            finish: 3000
        };
        
        // Material costs - SC Johnson products
        const materialCosts = {
            stripper: 45.00,
            sealer: 28.00,
            finish: 28.00,
            pads: 3.50,
            supplies: 0.03
        };
        
        // Material costs calculated from case prices
        function getMaterialCosts() {
            const stripperCasePrice = parseFloat(document.getElementById('stripperCasePrice').value) || 90;
            const finishCasePrice = parseFloat(document.getElementById('finishCasePrice').value) || 140;
            
            return {
                stripper: stripperCasePrice / 2,  // 2-gallon case = price per gallon
                finish: finishCasePrice / 5,      // 5-gallon case = price per gallon
                pads: 3.50,                       // Per pad - stripping pads
                supplies: 0.03                    // Per sq ft misc supplies (tack cloths, etc.)
            };
        }
        
        function updateVendorRate() {
            try {
                const rawRate = parseFloat(document.getElementById('rawLaborRate').value) || 16;
                const loadFactor = parseFloat(document.getElementById('loadFactor').value) || 1.5;
                const vendorRate = rawRate * loadFactor;
                document.getElementById('vendorLoadedRate').value = vendorRate.toFixed(2);
                
                // Update the helper text to show calculation
                const helpText = document.querySelector('#vendorLoadedRate + small');
                helpText.textContent = `Auto-calculated: ${rawRate.toFixed(2)} × ${loadFactor} = ${vendorRate.toFixed(2)}`;
                
            } catch (error) {
                console.error('Error updating vendor rate:', error);
            }
        }
        
        function calculatePricing() {
            try {
                const squareFootage = parseFloat(document.getElementById('squareFootage').value) || 0;
                const condition = document.getElementById('condition').value;
                const density = document.getElementById('density').value;
                const coats = parseInt(document.getElementById('coats').value);
                const rawLaborRate = parseFloat(document.getElementById('rawLaborRate').value) || 16;
                const vendorLoadedRate = parseFloat(document.getElementById('vendorLoadedRate').value) || 24;
                const equipmentRate = parseFloat(document.getElementById('equipmentRate').value) || 8;
                const crewSize = parseInt(document.getElementById('crewSize').value);
                const cwMargin = parseFloat(document.getElementById('cwMargin').value) || 35;
                const timeOfService = document.getElementById('timeOfService').value;
                
                if (squareFootage <= 0) {
                    alert('Please enter a valid square footage.');
                    return;
                }
                
                // Get production rates
                const stripRate = productionRates.strip[condition];
                const finishRate = productionRates.finish[coats];
                const prepRate = productionRates.prep;
                
                // Calculate density multiplier and description
                let densityMultiplier = 1.0;
                let furnitureDescription = "";
                
                switch(density) {
                    case 'none':
                        densityMultiplier = 0.9;
                        furnitureDescription = "No furniture to move";
                        break;
                    case 'minimal':
                        densityMultiplier = 1.0;
                        furnitureDescription = "Minimal furniture moving";
                        break;
                    case 'light':
                        densityMultiplier = 1.15;
                        furnitureDescription = "Light furniture moving";
                        break;
                    case 'medium':
                        densityMultiplier = 1.3;
                        furnitureDescription = "Moderate furniture moving";
                        break;
                    case 'heavy':
                        densityMultiplier = 1.5;
                        furnitureDescription = "Heavy furniture moving";
                        break;
                    case 'very_heavy':
                        densityMultiplier = 1.8;
                        furnitureDescription = "Extensive furniture/equipment moving";
                        break;
                    default:
                        densityMultiplier = 1.0;
                        furnitureDescription = "Standard conditions";
                }
                
                // Calculate base hours
                const stripHours = (squareFootage / stripRate * 8) * densityMultiplier;
                const finishHours = (squareFootage / finishRate * 8) * densityMultiplier;
                const prepHours = (squareFootage / prepRate * 8);
                let totalHours = stripHours + finishHours + prepHours;
                
                // Time of service multiplier
                let timeMultiplier = 1.0;
                if (timeOfService === 'overtime') timeMultiplier = 1.25;
                if (timeOfService === 'weekend') timeMultiplier = 1.35;
                
                // Material calculations using current case prices
                const materialCosts = getMaterialCosts();
                const stripperGallons = Math.ceil(squareFootage / materialCoverage.stripper);
                const finishGallons = Math.ceil((squareFootage * coats) / materialCoverage.finish);
                const sealerGallons = 0; // No separate sealer needed with SC Johnson system
                
                const stripperCost = stripperGallons * materialCosts.stripper;
                const finishCost = finishGallons * materialCosts.finish;
                const sealerCost = 0; // No separate sealer cost
                const padsCost = Math.ceil(squareFootage / 2000) * materialCosts.pads;
                const suppliesCost = squareFootage * materialCosts.supplies;
                
                const baseMaterialCost = stripperCost + finishCost + padsCost + suppliesCost;
                
                // Handle crew size - adjust time but maintain same cost per sq ft
                let finalVendorRate = vendorLoadedRate;
                if (crewSize > 1) {
                    totalHours = totalHours / crewSize;
                    finalVendorRate = vendorLoadedRate * crewSize;
                }
                
                // Labor and equipment costs (before margin)
                const vendorLaborCost = totalHours * finalVendorRate * timeMultiplier;
                const equipmentCost = totalHours * equipmentRate;
                
                // Total cost to City Wide (before margin)
                const totalCostToCW = vendorLaborCost + equipmentCost + baseMaterialCost;
                
                // Apply City Wide margin to EVERYTHING (labor, equipment, materials)
                const finalClientPrice = totalCostToCW / (1 - cwMargin/100);
                const cwGrossProfit = finalClientPrice - totalCostToCW;
                const pricePerSqFt = finalClientPrice / squareFootage;
                
                // Calculate material cost with margin for display
                const materialCostWithMargin = baseMaterialCost / (1 - cwMargin/100);
                
                // Update display
                document.getElementById('totalHours').textContent = totalHours.toFixed(1);
                document.getElementById('vendorLaborCost').textContent = '$' + vendorLaborCost.toFixed(0);
                document.getElementById('equipmentCost').textContent = '$' + equipmentCost.toFixed(0);
                document.getElementById('materialCost').textContent = '$' + materialCostWithMargin.toFixed(0);
                document.getElementById('totalCost').textContent = '$' + totalCostToCW.toFixed(0);
                document.getElementById('pricePerSqFt').textContent = '$' + pricePerSqFt.toFixed(2);
                document.getElementById('bidPrice').textContent = '$' + finalClientPrice.toFixed(0);
                document.getElementById('cwProfit').textContent = '$' + cwGrossProfit.toFixed(0);
                
                // Show results
                document.getElementById('resultsSection').style.display = 'block';
                document.getElementById('breakdownSection').style.display = 'block';
                
                // Generate breakdown
                generateDetailedBreakdown({
                    squareFootage: squareFootage,
                    stripHours: stripHours.toFixed(1),
                    finishHours: finishHours.toFixed(1),
                    prepHours: prepHours.toFixed(1),
                    stripperGallons: stripperGallons,
                    finishGallons: finishGallons,
                    sealerGallons: 0, // No separate sealer
                    stripperCost: stripperCost,
                    finishCost: finishCost,
                    sealerCost: 0, // No separate sealer cost
                    padsCost: padsCost,
                    suppliesCost: suppliesCost,
                    baseMaterialCost: baseMaterialCost,
                    materialCostWithMargin: materialCostWithMargin,
                    vendorLaborCost: vendorLaborCost,
                    equipmentCost: equipmentCost,
                    totalCostToCW: totalCostToCW,
                    finalClientPrice: finalClientPrice,
                    cwGrossProfit: cwGrossProfit,
                    timeMultiplier: timeMultiplier,
                    cwMargin: cwMargin,
                    rawLaborRate: rawLaborRate,
                    vendorLoadedRate: finalVendorRate,
                    crewSize: crewSize,
                    furnitureDescription: furnitureDescription,
                    stripperCasePrice: parseFloat(document.getElementById('stripperCasePrice').value) || 90,
                    finishCasePrice: parseFloat(document.getElementById('finishCasePrice').value) || 140
                });
                
            } catch (error) {
                console.error('Error in calculatePricing:', error);
                alert('There was an error calculating the pricing. Please check your inputs.');
            }
        }
        
        function generateDetailedBreakdown(data) {
            try {
                const furnitureDesc = data.furnitureDescription || "Standard conditions";
                const rawRate = data.rawLaborRate || 16;
                const vendorRate = data.vendorLoadedRate || 24;
                const loadFactor = ((vendorRate / rawRate - 1) * 100).toFixed(1);
                
                const breakdownHtml = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #e74c3c;">
                            <h4 style="color: #e74c3c; margin-bottom: 15px;">Labor Cost Structure</h4>
                            <p><strong>Raw Labor Rate:</strong> $${rawRate}/hr</p>
                            <p><strong>Vendor Loaded Rate:</strong> $${vendorRate}/hr</p>
                            <p><strong>Total Hours:</strong> ${(parseFloat(data.stripHours) + parseFloat(data.finishHours) + parseFloat(data.prepHours)).toFixed(1)} hrs</p>
                            <p><strong>Vendor Labor Cost:</strong> $${data.vendorLaborCost.toFixed(0)}</p>
                            <p><strong>Equipment Cost:</strong> $${data.equipmentCost.toFixed(0)}</p>
                        </div>
                        
                        <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #f39c12;">
                            <h4 style="color: #f39c12; margin-bottom: 15px;">Material Cost Structure</h4>
                            <p><strong>Base Material Cost:</strong> ${data.baseMaterialCost.toFixed(0)}</p>
                            <p><strong>Stripper Case Price:</strong> ${data.stripperCasePrice}/case (2 gal)</p>
                            <p><strong>Finish Case Price:</strong> ${data.finishCasePrice}/case (5 gal)</p>
                            <p><strong>Material Cost w/ Margin:</strong> ${data.materialCostWithMargin.toFixed(0)}</p>
                        </div>
                        
                        <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #27ae60;">
                            <h4 style="color: #27ae60; margin-bottom: 15px;">City Wide Pricing</h4>
                            <p><strong>Total Cost to CW:</strong> ${data.totalCostToCW.toFixed(0)}</p>
                            <p><strong>CW Margin:</strong> ${data.cwMargin}% (applies to all costs)</p>
                            <p><strong>Final Client Price:</strong> ${data.finalClientPrice.toFixed(0)}</p>
                            <p><strong>CW Gross Profit:</strong> ${data.cwGrossProfit.toFixed(0)}</p>
                        </div>
                        
                        <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #8e44ad;">
                            <h4 style="color: #8e44ad; margin-bottom: 15px;">Task & Furniture Breakdown</h4>
                            <p><strong>Stripping:</strong> ${data.stripHours} hours</p>
                            <p><strong>Finishing:</strong> ${data.finishHours} hours</p>
                            <p><strong>Prep Work:</strong> ${data.prepHours} hours</p>
                            <p><strong>Furniture Situation:</strong> ${furnitureDesc}</p>
                            <p><strong>Time Multiplier:</strong> ${data.timeMultiplier}x</p>
                        </div>
                    </div>
                `;
                
                document.getElementById('detailedBreakdown').innerHTML = breakdownHtml;
                
                const materialHtml = `
                    <div class="material-item">
                        <h4>Vendor Rate Analysis</h4>
                        <p>Raw Rate: $${rawRate}/hr</p>
                        <p>Loaded Rate: $${vendorRate}/hr</p>
                        <p>Load Factor: ${loadFactor}%</p>
                    </div>
                    <div class="material-item">
                        <h4>SC Johnson Hyper Concentrate Stripper</h4>
                        <p>Dilution: 1:8 to 1:24 ratio</p>
                        <p>Coverage: ~600 sq ft/gal (diluted)</p>
                        <p>Needed: ${data.stripperGallons} gallons</p>
                        <p>Cost: ${data.stripperCost.toFixed(0)}</p>
                    </div>
                    <div class="material-item">
                        <h4>SC Johnson Multi-Surface Floor Finish</h4>
                        <p>Coverage: 3,000 sq ft/gal per coat</p>
                        <p>Needed: ${data.finishGallons} gallons</p>
                        <p>Cost: ${data.finishCost.toFixed(0)}</p>
                    </div>
                    <div class="material-item">
                        <h4>Equipment & Labor Efficiency</h4>
                        <p>Crew Size: ${data.crewSize} person(s)</p>
                        <p>${data.crewSize > 1 ? 'Faster completion, same cost/sq ft' : 'Standard single-person rate'}</p>
                        <p>Equipment Rate: Includes transport, setup, depreciation</p>
                    </div>
                `;
                
                document.getElementById('materialCalc').innerHTML = materialHtml;
                
            } catch (error) {
                console.error('Error in generateDetailedBreakdown:', error);
            }
        }
        
        // Initialize on page load
        window.onload = function() {
            try {
                updateVendorRate();
                calculatePricing();
            } catch (error) {
                console.error('Error on page load:', error);
            }
        };
    </script>
</body>
</html>